

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Summary &#8212; dm4bem</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/00_Summary';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Theory in a nutshell" href="T00_theory.html" />
    <link rel="prev" title="Dynamic Models for Building Energy Management" href="../intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Dynamic Models for Building Energy Management
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Summary</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="T00_theory.html">Theory in a nutshell</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="T01_Heat_transfer.html">Thermal networks for heat trasfer in buildings</a></li>
<li class="toctree-l2"><a class="reference internal" href="T02_TC2DAE.html">From thermal networks to differential-algebraic equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="T03_DAE2SS.html">From differential-algebraic equations to state-space representation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="01WeatherData.html">Weather data and solar radiation on a tilted surface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="02_0ModelSimulation.html">Modeling and simulation</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="02_1Wall.html">Simple wall</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="02_2_0Toy.html">Toy model house</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="02_2_1Toy.html">Modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_2_2Toy.html">Steady-state and step response</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_2_3Toy.html">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_2_4Toy.html">Simulation: perfect controller</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pdREADME.html">Assembling thermal circuits</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="pd01wall2TC.html">Disassembled thermal circuits from wall description</a></li>
<li class="toctree-l2"><a class="reference internal" href="pd02bldg2TCd.html">Disassembled thermal circuits from building description</a></li>
<li class="toctree-l2"><a class="reference internal" href="pd03assembleTCd.html">Assembled thermal circuits</a></li>
<li class="toctree-l2"><a class="reference internal" href="pd04tc2ss.html">Thermal circuit to state-space</a></li>
<li class="toctree-l2"><a class="reference internal" href="pd05simulation.html">Inputs and simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="pd06nonlin.html">Nonlinear controller</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="A00annexes.html">Solved problems</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="A01Coupled_rad_convection.html">Radiation coupled with convection</a></li>
<li class="toctree-l2"><a class="reference internal" href="A02Thermal_load.html">Sensible thermal load in steady-state</a></li>
<li class="toctree-l2"><a class="reference internal" href="A03Air_flow_ventilation.html">Air flow by ventilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="A04Degree_hours_intermittance.html">Degree-hour estimation of energy savings by intermittent heating</a></li>
<li class="toctree-l2"><a class="reference internal" href="A05Greenhouse_effect.html">Greenhouse effect</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cghiaus/dm4bem_book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Dépôt source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cghiaus/dm4bem_book/issues/new?title=Issue%20on%20page%20%2Ftutorials/00_Summary.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Ouvrez un problème"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Téléchargez cette page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tutorials/00_Summary.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Télécharger le fichier source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimer au format PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Mode plein écran"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Summary</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenu </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-another-dynamic-thermal-simulation-tool">Why another dynamic thermal simulation tool?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features-of-dm4bem-method">Features of <em>dm4bem</em> method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structures">Data structures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-circuit">Thermal circuit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-representation">State representation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#information-on-walls-and-building">Information on walls and building</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithms">Algorithms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assembly">Assembly</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation-of-thermal-circuit-into-state-representation">Transformation of thermal circuit into state representation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#workflow">Workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h1>
<p>State-space representation is widely used in the synthesis and analysis of dynamic systems, with applications particularly in control engineering. However, existing simulation tools often do not find the state-space representation. Dynamic Models for Building Energy Management (<a class="reference download internal" download="" href="../_downloads/e4cbb7ae60f13bdac333462cf05e9574/dm4bem.py"><span class="xref download myst">dm4bem</span></a>) is a Python module that offers an innovative methodology for modelling heat and mass transfer using weighted directed graphs, also known as thermal circuits or networks. The methodology allows assembling the circuits to obtain complex models from constituent elements, and then transforming them into state-space representation. This representation provides several advantages, including the ability to analyse the eigenvalues of the transfer matrix, perform numerical integration for simulation, and synthesize control algorithms. Nonlinear models can be dealt with through linearization at each time step. This procedure is presented in this interactive book in which the code and tutorials can be run online.</p>
<section id="why-another-dynamic-thermal-simulation-tool">
<h2>Why another dynamic thermal simulation tool?<a class="headerlink" href="#why-another-dynamic-thermal-simulation-tool" title="Permalink to this headline">#</a></h2>
<p>Building energy management can significantly contribute to lower building consumption (<a class="reference external" href="https://doi.org/10.1016/j.rser.2022.112099">Van Thillo, Verbeke, &amp; Audenaert, 2022</a>). In this context, modeling and simulating heat and mass transfer play a crucial role in understanding and optimizing building energy performance. Traditionally, building dynamic thermal simulation software, such as <a class="reference external" href="https://www.trnsys.com">TRNSYS</a>, <a class="reference external" href="https://energyplus.net">EnergyPlus</a>, <a class="reference external" href="https://www.equa.se/en/ida-ice">IDA ICE</a>, <a class="reference external" href="https://www.ces.minesparis.psl.eu/Logiciels/COMFIE/">COMFIE</a> &amp; <a class="reference external" href="https://www.izuba.fr/logiciels/">PLEIADES</a>, <a class="reference external" href="http://www.jnlog.com/kozibu1_en.htm">KoZiBu</a>, rely on iterative solving of balance equations that couple models of different constituent elements. This approach does not provide a state representation of the system, limiting the analysis and synthesis of control systems. State-space representation can be obtained by using plateformes such as <a class="reference external" href="https://mathworks.com/products/simulink.html">MATLAB/Simulink</a>. Another characteristic of current software is that they use a graphical interface, which facilitates building design but makes reproducibility difficult. Finally, current solutions use proprietary software components. These software are adapted and largely used for building design and energy performance simulation.</p>
<p>The method and the Python module (<a class="reference download internal" download="" href="../_downloads/e4cbb7ae60f13bdac333462cf05e9574/dm4bem.py"><span class="xref download myst">dm4bem</span></a>) (Dynamic Models for Building Energy Management) offer an innovative approach to modeling heat and mass transfer in buildings with application to control engineering. Unlike traditional coupling methods, thermal models in <a class="reference download internal" download="" href="../_downloads/e4cbb7ae60f13bdac333462cf05e9574/dm4bem.py"><span class="xref download myst">dm4bem</span></a> are obtained by assembling. This approach has the advantage of providing a single model instead of several separate coupled models. Furthermore, thermal circuits are transformed into state representation, opening up new perspectives for analysis and synthesis of control systems for building energy management. The module, written in Python, is open-source and free to use.</p>
</section>
<section id="features-of-dm4bem-method">
<h2>Features of <em>dm4bem</em> method<a class="headerlink" href="#features-of-dm4bem-method" title="Permalink to this headline">#</a></h2>
<p>The modeling in <a class="reference download internal" download="" href="../_downloads/e4cbb7ae60f13bdac333462cf05e9574/dm4bem.py"><span class="xref download myst">dm4bem</span></a> utilizes thermal networks (or thermal circuits), which are weighted directed graphs (Figure 1) where:</p>
<ul class="simple">
<li><p>Nodes (or vertices) represent homogeneous temperatures, <span class="math notranslate nohighlight">\(\theta\)</span>, of geometric points (0D), lines (1D), surfaces (2D), or volumes (3D).</p></li>
<li><p>Directed links (or edges) represent heat flow rates, <span class="math notranslate nohighlight">\(q\)</span>, between temperature nodes.</p></li>
</ul>
<p><img alt="basic_TC" src="../_images/A01_Basic_thermal_circuit.svg" /></p>
<blockquote>
<div><p>Figure 1. Basic thermal network.</p>
</div></blockquote>
<p><img alt="procedure" src="../_images/A02_calc_procedure.svg" /></p>
<blockquote>
<div><p>Figure 2. Obtaining the system of differential-algebraic equations from a thermal network: a) General framework. b) Temperature differences. c) Flow rates (constitutive laws). d) Energy balance.</p>
</div></blockquote>
<p><img alt="T2DAE" src="../_images/A02_TC2DAE.svg" /></p>
<blockquote>
<div><p>Figure 3. Example of differential-algebraic system of equations for a thermal network: a) Thermal network. b) Matrices and vectors. c) Differencial-algebraic equations (DAE).</p>
</div></blockquote>
<p>Thermal circuits are a visual representation of <a class="reference external" href="https://en.m.wikipedia.org/wiki/Constitutive_equation">constitutive laws</a> and <a class="reference external" href="https://en.m.wikipedia.org/wiki/Balance_equation">energy balance equations</a> (Figure 2 c and d, respectively). Mathematical models, in the form of differential-algebraic equations, are obtained from the thermal circuits using the methodology presented in Figure 2a. An example is provided in Figure 3.</p>
</section>
<section id="data-structures">
<h2>Data structures<a class="headerlink" href="#data-structures" title="Permalink to this headline">#</a></h2>
<section id="thermal-circuit">
<h3>Thermal circuit<a class="headerlink" href="#thermal-circuit" title="Permalink to this headline">#</a></h3>
<p>The <em>dm4bem</em> method proposes a specific data structure: the thermal circuit (TC). It consists of a dictionary composed of (Figure 3b):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span>: branch (flow rate) - node (temperature) incidence matrix;</p></li>
<li><p><span class="math notranslate nohighlight">\(G\)</span>: vector representing the diagonal of the conductance matrix;</p></li>
<li><p><span class="math notranslate nohighlight">\(C\)</span>: vector representing the diagonal of the capacitance matrix;</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span>: vector containing the names of temperature sources on the branches;</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span>: vector containing the names of flow rate sources in the nodes;</p></li>
<li><p><span class="math notranslate nohighlight">\(y\)</span>: vector indicating the temperature nodes considered as outputs.</p></li>
</ul>
<p>These vectors and matrices allow writing a system of differential-algebraic equations (Figure 2 and Figure 3):</p>
<div class="math notranslate nohighlight">
\[C \dot\theta = -A^T G A \theta + A^T G b + f\]</div>
<p>Once the system of differential-algebraic equations has been solved for temperatures <span class="math notranslate nohighlight">\(\theta\)</span>, the flow-rates <span class="math notranslate nohighlight">\(q\)</span> are determined:</p>
<div class="math notranslate nohighlight">
\[ q = G(-A \theta + b)\]</div>
<p>Thermal circuits can be built in Python or specified in a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file.</p>
</section>
<section id="state-representation">
<h3>State representation<a class="headerlink" href="#state-representation" title="Permalink to this headline">#</a></h3>
<p>The state representation is obtained by eliminating the algebraic equations from the thermal circuits, i.e., by considering only the nodes with capacitances (<a class="reference external" href="https://doi.org/10.1016/j.energy.2012.10.024">Ghiaus, C. 2013</a>). It contains:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span>: state matrix;</p></li>
<li><p><span class="math notranslate nohighlight">\(B\)</span>: control matrix;</p></li>
<li><p><span class="math notranslate nohighlight">\(C\)</span>: observation matrix;</p></li>
<li><p><span class="math notranslate nohighlight">\(D\)</span>: direct action matrix;</p></li>
<li><p><span class="math notranslate nohighlight">\(u\)</span>: correspondence table between branches &amp; nodes with sources and their names, i.e., the list of non-zero elements of vectors b &amp; f, as well as their respective positions in these vectors.</p></li>
</ul>
</section>
<section id="information-on-walls-and-building">
<h3>Information on walls and building<a class="headerlink" href="#information-on-walls-and-building" title="Permalink to this headline">#</a></h3>
<p>For the thermal models of buildings, a special case is represented by the walls. The description of the walls is provided in a directory that contains two types of files:</p>
<ul class="simple">
<li><p><em>Wall types</em>: thermo-physical properties of materials.</p></li>
<li><p><em>Wall data</em>: surface area, temperature and flow rate sources, convection and radiation coefficients of surfaces.</p></li>
</ul>
<p>From this information, the thermal circuit of a wall is obtained (the matrices and vectors <span class="math notranslate nohighlight">\(A, G, C, b, f, y\)</span>).</p>
<p>A building can be described in a directory (or folder) containing:</p>
<ul class="simple">
<li><p>Walls ([wall types]((./pd/bldg/wall_types.csv) and <a class="reference download internal" download="" href="../_downloads/f482e00d9eb41e41a6117b2ae8cea23c/walls_out.csv"><span class="xref download myst">walls data</span></a>) noted as <code class="docutils literal notranslate"><span class="pre">ow0</span></code> in Figure 4.</p></li>
<li><p>Thermal circuits noted as <a class="reference download internal" download="" href="../_downloads/9a256d722b5b062a1774116413365edd/TC0.csv"><span class="xref download myst">TC0</span></a>, <a class="reference download internal" download="" href="../_downloads/43810beeba230817e2ca3f9e69d61d76/TC1.csv"><span class="xref download myst">TC1</span></a>, <a class="reference download internal" download="" href="../_downloads/ee27542d019ba5050a8a58e620608e28/TC2.csv"><span class="xref download myst">TC2</span></a>, <a class="reference download internal" download="" href="../_downloads/be4f7ea0b5445a9aaa9e0e508616fc97/TC3.csv"><span class="xref download myst">TC3</span></a> in Figure 4.</p></li>
<li><p>The assembly <a class="reference download internal" download="" href="../_downloads/1d6fd7662441ed7d5978b09626cedff9/assembly_matrix.csv"><span class="xref download myst">matrix</span></a>  or <a class="reference download internal" download="" href="../_downloads/88de4bd1b17c3d1a2b96ac54619de117/assembly_lists.csv"><span class="xref download myst">list</span></a> indicating the nodes that merge (connected by dashed lines in Figure 4).</p></li>
</ul>
</section>
</section>
<section id="algorithms">
<h2>Algorithms<a class="headerlink" href="#algorithms" title="Permalink to this headline">#</a></h2>
<p>There are two significant algorithms: thermal circuit assembly and conversion of thermal circuits into state representation.</p>
<section id="assembly">
<h3>Assembly<a class="headerlink" href="#assembly" title="Permalink to this headline">#</a></h3>
<p>A set of disassembled thermal circuits is assembled into a single thermal circuit (Figure 4). Assembling can be performed by using an assembly matrix or assembly lists. The assembly matrix indicates two nodes to merge. For example, in Figure 4, node 0 of circuit c2 (in purple) merges with node 5 of circuit ow0 (the second node will no longer exist after the merger). The assembly list indicates the node that is kept after merging, for example, node 0 of circuit c2, and a list of nodes that merge, for example, node 5 of circuit ow0 and node 2 of circuit c1.</p>
<p><img alt="disassambled_TC" src="../_images/ass_TC.svg" /></p>
<blockquote>
<div><p>Figure 4. Assembling four circuits.</p>
</div></blockquote>
</section>
<section id="transformation-of-thermal-circuit-into-state-representation">
<h3>Transformation of thermal circuit into state representation<a class="headerlink" href="#transformation-of-thermal-circuit-into-state-representation" title="Permalink to this headline">#</a></h3>
<p>By eliminating the algebraic equations, the system of differential-algebraic equations can be transformed into state representation (<a class="reference external" href="https://doi.org/10.1016/j.energy.2012.10.024">Ghiaus, C. 2013</a>).</p>
</section>
</section>
<section id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">#</a></h2>
<p><img alt="work_flow" src="../_images/work_flow.svg" /></p>
<blockquote>
<div><p>Figure 5. Workflow for building simulation by using <code class="docutils literal notranslate"><span class="pre">dm4bem</span></code> module.</p>
</div></blockquote>
<p>The <a class="reference external" href="https://en.m.wikipedia.org/wiki/Workflow">workflow</a> for modeling and simulation with <a class="reference download internal" download="" href="../_downloads/e4cbb7ae60f13bdac333462cf05e9574/dm4bem.py"><span class="xref download myst">dm4bem</span></a> is (Figure 5):</p>
<ul class="simple">
<li><p><strong>Modelling:</strong> obtain the thermal circuit and the state-space representation.</p>
<ul>
<li><p>Draw the thermal network based on the description of the building and on modelling assumptions.</p></li>
<li><p>Calculate the parameters of the thermal network: conductances and capacities.</p></li>
<li><p>Write the matrices and vectors (<span class="math notranslate nohighlight">\(A, G, C, b, f, y\)</span>) of the differential algebraic equations.</p></li>
<li><p>Create the thermal circuit <strong>TC</strong> and convert it to state-space representation (matrices <span class="math notranslate nohighlight">\(A_s, B_s, C_s, D_s\)</span> and input vector <span class="math notranslate nohighlight">\(u_s\)</span>).</p></li>
</ul>
</li>
<li><p><strong>Tests in steady-state and step respose:</strong> test if the model is wrong (<a class="reference external" href="https://en.wikipedia.org/wiki/Falsifiability">falsifiability</a>). If the model fails these tests, then it is wrong; if the model passes these tests, it does not mean it is correct.</p>
<ul>
<li><p>Compare and interpret the steady-state results obtained for thermal circuit and state-space representation.</p></li>
<li><p>Perform eigenvalue analysis of the state matrix <span class="math notranslate nohighlight">\(A_s\)</span> of the state-space representation and analyse the maximum time step (for numerical integration with <a class="reference external" href="https://en.wikipedia.org/wiki/Euler_method">Euler explicit or forward method</a>) and the <a class="reference external" href="https://en.wikipedia.org/wiki/Settling_time">settling time</a>. If the maximum time step is:</p>
<ul>
<li><p>too small: set to zero the capacities that with the related conductance (or resistance) produce the small time step (e.g., air, windows, doors);</p></li>
<li><p>too large: consider the discretization of elements which have large capacities (e.g., walls, ground).</p></li>
</ul>
</li>
<li><p>Simulate the time response (by using <a class="reference external" href="https://en.wikipedia.org/wiki/Explicit_and_implicit_methods">Euler explicit and implicit method</a>) to different <a class="reference external" href="https://en.wikipedia.org/wiki/Step_response">step inputs</a>.</p></li>
<li><p>Compare the settling time obtained from simulation of step response with that obtained by eigenvalue analysis.</p></li>
<li><p>Compare the steady-state value obtained by simumation of from the models (therma circuit and state-space representation).</p></li>
</ul>
</li>
<li><p><strong>Inputs:</strong> prepare the input data set, i.e., time variation of weather and scheduled sources of temperature and flow-rate.</p>
<ul>
<li><p>Read the weather data (outdoor temperature, direct solar irradiance and diffuse solar irradiace).</p></li>
<li><p>Calculate the solar irradiance on the outdoor and indoor surfaces of the walls.</p></li>
<li><p>Define the schedules for temperature sources (e.g., indoor temperature set point) and flow rate sources (e.g., internal gains).</p></li>
<li><p>Obtain the input data set.</p></li>
</ul>
</li>
<li><p><strong>Simulation:</strong> integrate in time the model for the given inputs.</p>
<ul>
<li><p>Transform the input data set into input vector in time for state-space representation.</p></li>
<li><p>Set the initial conditions.</p></li>
<li><p>Integrate the states in time (e.g., by using <a class="reference external" href="https://en.wikipedia.org/wiki/Euler_method">Euler forward</a> and/or <a class="reference external" href="https://en.wikipedia.org/wiki/Backward_Euler_method">backward</a> methods).</p></li>
<li><p>Calculate the outputs from the states.</p></li>
<li><p>Plot the results.</p></li>
</ul>
</li>
</ul>
</section>
<section id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">#</a></h2>
<p>Dynamic Models for Building Energy Management (<a class="reference download internal" download="" href="../_downloads/e4cbb7ae60f13bdac333462cf05e9574/dm4bem.py"><span class="xref download myst">dm4bem</span></a>) method offers an efficient approach to obtaining thermal models by assembling different models. The main contributions of the method lie in the following aspects:</p>
<ul class="simple">
<li><p>Definition of a data structure describing thermal circuits as weighted directed graphs, described by matrices and vectors <span class="math notranslate nohighlight">\(A, G, C, b, f, y.\)</span></p></li>
<li><p>Considering, in the state representation <span class="math notranslate nohighlight">\(A_s, B_s, C_s, D_s, u_s,\)</span> the correspondence table <span class="math notranslate nohighlight">\(u_s\)</span> between the non-zero elements of vectors <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(f\)</span> and the names of temperature and flow rate sources, respectively.</p></li>
<li><p>Assembly of thermal circuits by merging nodes (temperature nodes) and the consequent transformation of matrices and vectors <span class="math notranslate nohighlight">\(A, G, C, b, f, y.\)</span></p></li>
<li><p>Transformation of the thermal circuit (directed graph) into state representation.</p></li>
<li><p>Procedure for generating thermal circuits for walls (generic, exterior, and interior).</p></li>
<li><p>Folder structure allowing characterization of a building based on the description of walls, thermal circuits, and connection matrix, as well as the procedure for creating the thermal circuit.</p></li>
<li><p>Implementation of these concepts in Python and the presentation of tutorials in this freely accessible Jupyter.</p></li>
</ul>
<p>By transforming thermal circuits into state representations, this method enables their use in the analysis and synthesis of control algorithms. Eigenvalue analysis of the state matrix provides important information about integration time step and response time, as well as proper choices in spatial discretization. By integrating non-linearities into the time integration loop, it is possible to model non-linear control parameters and/or algorithms. <em>dm4bem</em> uses text-based commands and model descriptions, facilitating reproducibility.</p>
<p>The current main drawback is that buildings are not described by using Computer-Aided Design (CAD) tools, which would enable automatic irradiance calculations. Another improvement would be to use sparse matrices to reduce memory usage.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1016/j.energy.2012.10.024">Ghiaus, C. (2013)</a>. Causality issue in the heat balance method for calculating the design heating and cooling loads, <em>Energy</em> 50: 292-301, <a class="reference external" href="https://hal.archives-ouvertes.fr/hal-03605823/document">hal-03605823</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.rser.2022.112099">Van Thillo, L., Verbeke, S., &amp; Audenaert, A. (2022)</a>. The potential of building automation and control systems to lower the energy demand in residential buildings: A review of their performance and influencing parameters. Renewable and Sustainable Energy Reviews, 158, 112099.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Dynamic Models for Building Energy Management</p>
      </div>
    </a>
    <a class="right-next"
       href="T00_theory.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Theory in a nutshell</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenu
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-another-dynamic-thermal-simulation-tool">Why another dynamic thermal simulation tool?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features-of-dm4bem-method">Features of <em>dm4bem</em> method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structures">Data structures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-circuit">Thermal circuit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-representation">State representation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#information-on-walls-and-building">Information on walls and building</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithms">Algorithms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assembly">Assembly</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation-of-thermal-circuit-into-state-representation">Transformation of thermal circuit into state representation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#workflow">Workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Par Christian Ghiaus
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>